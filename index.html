<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–°–µ—Ä–≤–µ—Ä –ú—É—Ä–∏–Ω–æ</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    font-family: "Segoe UI", sans-serif;
    background-color: #2f3136;
    color: #ffffff;
  }

  header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 30px;
    background-color: #36393f;
    box-shadow: 0 2px 6px rgba(0,0,0,0.5);
    flex-shrink: 0;
  }

  header h1 {
    font-size: 20px;
    margin: 0;
  }

  header button {
    background-color: #5865F2;
    border: none;
    padding: 8px 15px;
    border-radius: 5px;
    color: white;
    cursor: pointer;
    font-weight: bold;
  }

  header button:hover {
    background-color: #4752c4;
  }

  main {
    display: flex;
    justify-content: space-around;
    padding: 20px;
    gap: 20px;
    height: calc(100% - 70px);
    box-sizing: border-box;
  }

  .stats {
    display: flex;
    flex-direction: column;
    gap: 15px;
    min-width: 180px;
    flex-shrink: 0;
  }

  .stat-block {
    background-color: #36393f;
    padding: 15px;
    border-radius: 10px;
    text-align: center;
    font-size: 18px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.5);
    transition: transform 0.2s;
  }

  .stat-block:hover {
    transform: translateY(-2px);
  }

  .stat-block span {
    display: block;
    font-size: 30px;
    margin-bottom: 5px;
  }

  .join-btn {
    margin-top: 10px;
    background-color: #5865F2;
    border: none;
    padding: 10px;
    border-radius: 8px;
    color: white;
    font-weight: bold;
    cursor: pointer;
    width: 100%;
  }

  .join-btn:hover {
    background-color: #4752c4;
  }

  .announcements {
    flex: 1;
    background-color: #40444b;
    border-radius: 10px;
    padding: 15px;
    max-height: 300px; /* –º–µ–Ω—å—à–µ, —á–µ–º —Ä–∞–Ω—å—à–µ */
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .activity-block {
    flex-shrink: 0;
    background-color: #36393f;
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.5);
    margin-top: 15px;
    text-align: center;
  }

  .announcement-card {
    background-color: #2f3136;
    border-radius: 8px;
    padding: 10px;
    box-shadow: 0 1px 5px rgba(0,0,0,0.5);
    opacity: 0;
    animation: fadeIn 0.5s forwards;
  }

  .announcement-card img {
    max-width: 100%;
    border-radius: 6px;
    pointer-events: none;
    user-select: none;
    margin-top: 5px;
  }

  @keyframes fadeIn {
    to { opacity: 1; }
  }

  @media (max-width: 800px) {
    main {
      flex-direction: column;
      align-items: center;
      height: auto;
    }
    .stats, .announcements, .activity-block {
      width: 90%;
    }
  }
</style>
</head>
<body>
  <header>
    <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Å–∞–π—Ç —Å–µ—Ä–≤–µ—Ä–∞ üìç–ú—É—Ä–∏–Ω–æ</h1>
    <button onclick="switchPage()">–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ Minecraft</button>
  </header>

  <main>
    <div class="stats">
      <div class="stat-block"><span>üë•</span> <div id="total-members">0</div> –í—Å–µ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
      <div class="stat-block"><span>üíª</span> <div id="online-members">0</div> –û–Ω–ª–∞–π–Ω</div>
      <div class="stat-block"><span>üé§</span> <div id="voice-members">0</div> –í –≤–æ–π—Å–µ</div>
      <button class="join-btn" onclick="window.open('https://discord.gg/–¢–í–û–ô_–°–°–´–õ–ö–ê')">–í—Å—Ç—É–ø–∏—Ç—å –≤ Discord</button>

      <!-- –ë–ª–æ–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ -->
      <div class="activity-block">
        <h3>–¢–µ–∫—É—â–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å üéÆ</h3>
        <div id="current-activity">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</div>
      </div>
    </div>

    <div class="announcements" id="announcements">
      <!-- –æ–±—ä—è–≤–ª–µ–Ω–∏—è –ø–æ–¥—Ç—è–≥–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
    </div>
  </main>

  <script>
    function switchPage() {
      window.location.href = '/minecraft.html';
    }

    async function loadData() {
      try {
        const res = await fetch('data.json?' + Date.now());
        const data = await res.json();

        document.getElementById('total-members').textContent = data.totalMembers;
        document.getElementById('online-members').textContent = data.onlineCount;
        document.getElementById('voice-members').textContent = data.voiceCount;

        // –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
        document.getElementById('current-activity').textContent = data.activityMessage || "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö";

        // –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π
        const announcementsDiv = document.getElementById('announcements');
        announcementsDiv.innerHTML = '';
        (data.messages || []).forEach((m, i) => {
          const card = document.createElement('div');
          card.className = 'announcement-card';
          card.style.animationDelay = `${i * 0.1}s`;

          let content = `<b>${m.author}</b> <small>${new Date(m.time).toLocaleString()}</small><div>${m.content}</div>`;
          (m.attachments || []).forEach(att => {
            if (att.contentType?.startsWith('image')) {
              content += `<img src="${att.url}" alt="media">`;
            }
          });

          card.innerHTML = content;
          announcementsDiv.appendChild(card);
        });
      } catch (err) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ data.json', err);
      }
    }

    loadData();
    setInterval(loadData, 30000);
  </script>
</body>
</html>
